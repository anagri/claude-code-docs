# Directory: tool-use

## Overview
This directory contains comprehensive documentation for Claude's tool use capabilities, covering both client-side and server-side tools that extend Claude's functionality to perform actions, access external resources, and interact with systems.

## Files in This Directory

### **bash-tool.md**
Documents the bash tool that enables Claude to execute shell commands in a persistent bash session. The tool maintains state between commands (environment variables, working directory) and supports development workflows, system automation, data processing, and environment setup. Available in Claude 4 models and Sonnet 3.7 with version `bash_20250124`. The tool requires client-side implementation to execute commands and return stdout/stderr results. Security considerations include running in isolated environments, command filtering, resource limits, and logging. Pricing adds 245 input tokens per request. Limitations include no interactive commands, no GUI applications, and session persistence only within conversations.

### **code-execution-tool.md**
Describes the code execution tool (currently in public beta) that allows Claude to run Bash commands and manipulate files in a secure sandboxed environment. Available on Claude 4 models, Sonnet 3.7, and Haiku 3.5 using version `code_execution_20250825`. The tool provides two sub-tools: `bash_code_execution` for shell commands and `text_editor_code_execution` for file operations. It supports uploading files via the Files API for analysis (CSV, Excel, JSON, XML, images) and can retrieve generated files. The sandbox includes pre-installed data science libraries (pandas, numpy, matplotlib), runs in a Linux container with 1GiB RAM, 5GiB storage, 1 CPU, and has no internet access. Container reuse is supported across API requests. Pricing is $0.05 per session-hour with a minimum of 5 minutes.

### **computer-use-tool.md**
Covers the computer use tool (beta feature) that enables Claude to interact with desktop environments through screenshot capabilities and mouse/keyboard control. Available in Claude 4 models and Sonnet 3.7 with version `computer_20250124`. The tool provides actions like screenshot, mouse clicks, typing, keyboard shortcuts, scrolling, dragging, and wait commands. Requires a sandboxed computing environment with virtual display (Xvfb), desktop environment (Mutter), and tool implementations. The reference implementation is available at anthropics/anthropic-quickstarts. Security considerations include using isolated environments, avoiding sensitive data access, limiting internet access, and human confirmation for critical decisions. Claude Sonnet 3.7 includes a thinking capability for transparency. Pricing adds 735 tokens per tool definition for Claude 4/Sonnet 3.7.

### **fine-grained-tool-streaming.md**
Explains the fine-grained tool streaming beta feature that allows streaming tool use parameters without buffering or JSON validation, reducing latency for large parameters. Enabled with beta header `fine-grained-tool-streaming-2025-05-14`. The feature streams chunks faster and with fewer breaks than standard streaming, but may result in invalid or partial JSON if `max_tokens` is reached. Applications must handle incomplete JSON by wrapping it in a JSON object when passing back to Claude. The feature demonstrates significant latency improvements (from 15s to 3s in examples) and produces longer, more coherent chunks.

### **implement-tool-use.md**
Provides comprehensive implementation guidance for tool use with Claude. Covers tool definition with JSON Schema, tool choice parameters (`auto`, `any`, `tool`, `none`), forcing tool use, JSON mode output, parallel tool execution, and handling tool results. Includes detailed formatting requirements: tool results must immediately follow tool use blocks, and in user messages containing tool results, tool_result blocks must come FIRST before any text. Explains the tool use system prompt structure, best practices for tool descriptions (detailed over examples), handling missing information, sequential tools, and chain of thought prompting. Provides complete code examples for parallel tool use testing and verification. Covers error handling including execution errors, invalid tool names, and the `pause_turn` stop reason for server tools. Details troubleshooting for parallel tool calls not working, including formatting mistakes and prompting improvements.

### **memory-tool.md**
Documents the memory tool (beta feature) that enables Claude to store and retrieve information across conversations through a file directory. Enabled with beta header `context-management-2025-06-27`. Available on Claude Sonnet 4.5, Sonnet 4, Opus 4.1, and Opus 4. The tool operates client-side with commands: view (directories/files with line ranges), create, str_replace, insert, delete, and rename. Claude automatically checks memory before starting tasks and records progress to handle potential interruptions. The system prompt instructs Claude to always view memory first. Security considerations include path traversal protection (must validate paths start with `/memories`), sensitive information handling, file size limits, and memory expiration. Implementation helpers are available in the SDKs (BetaAbstractMemoryTool for Python, betaMemoryTool for TypeScript).

### **overview.md**
Provides the foundational overview of tool use with Claude, distinguishing between client tools (user-defined and Anthropic-defined tools requiring client implementation) and server tools (executed on Anthropic's servers like web search and web fetch). Explains the tool use workflow: providing tools, Claude's decision to use them, executing tools, and returning results. Includes examples for single tools, parallel tools, multiple tools, missing information, sequential tools, chain of thought prompting, and JSON mode for structured output. Details pricing structure showing tool use system prompt token counts by model (ranging from 159 to 530 tokens depending on model and tool_choice). Links to cookbook examples for calculator tools, customer service agents, and JSON extraction.

### **text-editor-tool.md**
Documents the text editor tool for viewing and modifying text files, helping with code debugging, refactoring, documentation, and test creation. Available in Claude 4 models with version `text_editor_20250728` (without undo_edit), Sonnet 3.7 with `text_editor_20250124`, and deprecated Sonnet 3.5 with `text_editor_20241022`. Commands include: view (files/directories with optional line ranges), str_replace (exact text replacement), create (new files), insert (text at specific line), and undo_edit (Sonnet 3.7/3.5 only). The `text_editor_20250728` version adds optional `max_characters` parameter for truncating large files. Implementation is schema-less with the tool named `str_replace_based_edit_tool`. Best practices include clear context in prompts, explicit file paths, creating backups, handling unique text replacement, and verifying changes. Pricing adds 700 input tokens. Includes complete working examples of fixing syntax errors with multi-step view and edit operations.

### **token-efficient-tool-use.md**
Describes token-efficient tool use beta feature for Claude Sonnet 3.7 that saves an average of 14% in output tokens (up to 70%), reducing both costs and latency. Enabled with beta header `token-efficient-tools-2025-02-19`. Note that Claude 4 models do not support this feature (the beta header is a no-op). The feature is incompatible with `disable_parallel_tool_use`. When using the SDK, requires `anthropic.beta.messages`. Recommend using the Prompt Improver in Console to optimize prompts. To maintain prompt caching benefits, use the beta header consistently across requests.

### **web-fetch-tool.md**
Explains the web fetch tool (beta) for retrieving full content from web pages and PDF documents. Enabled with beta header `web-fetch-2025-09-10`. Available on Claude 4 models, Sonnet 3.7, deprecated Sonnet 3.5 v2, and Haiku 3.5. The tool can only fetch URLs that previously appeared in conversation context (user messages, tool results, or previous search/fetch results) - cannot fetch arbitrary URLs. Supports parameters: `max_uses`, `allowed_domains`, `blocked_domains`, `citations` (optional, unlike web search), and `max_content_tokens` for limiting fetched content. Caches results automatically to improve performance. Works with prompt caching and streaming. PDF documents are returned as base64-encoded data. Error codes include invalid_input, url_too_long, url_not_allowed, url_not_accessible, too_many_requests, unsupported_content_type, max_uses_exceeded, and unavailable. No additional charges beyond standard token costs. Warns about data exfiltration risks and recommends using in trusted environments.

### **web-search-tool.md**
Documents the web search tool that gives Claude real-time web access with automatic source citations. Available on Claude 4 models, Sonnet 3.7, deprecated Sonnet 3.5 v2, and Haiku 3.5. Requires organization administrator to enable in Console settings. Uses version `web_search_20250305` with parameters: `max_uses` (limits searches), `allowed_domains`/`blocked_domains` (domain filtering, must be compatible with organization-level restrictions), and `user_location` (for localized results with city, region, country, timezone). Citations are always enabled and include url, title, encrypted_index, and up to 150 characters of cited_text. Citation fields do not count toward token usage. Search results include url, title, page_age, and encrypted_content. Works with prompt caching (caches up to last web_search_tool_result) and streaming. Error codes include too_many_requests, invalid_input, max_uses_exceeded, query_too_long, and unavailable. Response may include `pause_turn` stop reason for long-running turns. Pricing is $10 per 1,000 searches plus standard token costs for search-generated content. Citations must be displayed to end users when showing API outputs directly.